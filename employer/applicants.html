<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Dei Jobs Dashboard</title>
	
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.31/dist/sweetalert2.min.css">
	<link rel="stylesheet" type="text/css" href="css/style.css">

</head>
<body>
	
	<div id="head_nav"></div>

	<section class="main_container">
		<div class="container py-5 dash_layout">
			<aside class="sidebar skeleton-qqky8cwf6lu" id="side_bar"></aside>
			<main>
				<div class="row mb-5">
					<div class="col-12">
						<div class="big_card applicants_screen">
							<div class="d-flex justify-content-between align-items-center mb-4">
							    <div>
								    <h5 class="fw-semibold">Applicants</h5>
								    <p class="fw-medium fs-10 text-body-secondary mb-0"><img src="images/icon/tick.png" class="me-2" alt=""><span id="total_applicant">0</span> applications received <span class="fw-normal">this month</span></p>
							    </div>
							    <div class="d-flex">
								    <input type="text" placeholder="Search" class="form-control me-4" id="search_by">								    
							    </div>

							</div>
							<div class="table-responsive">
								<table class="table">
									<thead>
									    <tr>
									      <th class="col-6">JOB POSTS</th>
									      <th class="col-3">APPLICANTS</th>
									      <th class="col-2">POSTED</th>
									      <th class="col-1">STATUS</th>
									    </tr>
									</thead>
									<tbody id="job_posts">
									</tbody>
								</table>

							</div>
						</div>
					</div>
				</div>
			</main>
		</div>
	</section>


	<div id="footer_div"></div>


	

	<script src="js/jquery-3.7.0.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.31/dist/sweetalert2.all.min.js"></script>
	<script src="js/api.js"></script>
	<script>
		$(document).ready(function(){
			// $("#menu_applicants").addClass('active');
        var get_applicant_url = api_url+'/api/get-applicant-dashboard-data';
        var postData = {
            "employeeId": localStorage.getItem('employeeId')
        };
        get_data(postData);
        function get_data(postData){        

	        $.ajax({
	            url: get_applicant_url,
	            type: 'POST',
	            contentType: 'application/json',
	            data: JSON.stringify(postData),
	            success: function(data) {
	                response_data = JSON.parse(data);
	                console.log(response_data);
	                if(response_data['code'] == 200){
	                    $("#total_applicant").html(response_data['totalRecievedApplication'])
	                    var job_posted = "";
	                    for(i=0; i<= response_data['jobPostsDetails'].length-1; i++){
	                        jobs_list = '<tr>'+
										      '<td><a href="job_post_applicants.html?jid='+response_data['jobPostsDetails'][i]['job_id']+'&jt='+response_data['jobPostsDetails'][i]['job_title']+'" class="txt-primary" target="blank">'+response_data['jobPostsDetails'][i]['job_title']+'</a></td>'+
										      '<td>'+response_data['jobPostsDetails'][i]['user_count']+'</td>'+
										      '<td>'+response_data['jobPostsDetails'][i]['posted']+'</td>'+
										      '<td>'+response_data['jobPostsDetails'][i]['job_status']+'</td>'+
										    '</tr>'
	                        job_posted = job_posted + jobs_list;
	                    $("#job_posts").html(job_posted);
	                    }

	                }else{
	                	Swal.fire('something went wrong');
	                }
	            },
	            error: function(jqXHR, textStatus, errorThrown) {
	                console.error('Error:', textStatus, errorThrown);
	            }
	        });
	    }
        var timer;
		$("#search_by").keyup(function() {
		    clearTimeout(timer);
		    timer = setTimeout(function() {
		        var search_txt = $('#search_by').val();
		        if (search_txt.length >= 3 || search_txt.length == 0) {
		            var postData = {
			            "employeeId": localStorage.getItem('employeeId'),
			            "job_title": search_txt
			        };
		            get_data(postData);
		        }
		    }, 250);
		});


    });		
	</script>	
</body>
</html>
